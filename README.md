# Screen Keypress Trainer & Simulator

This project provides a two-part system for training and simulating keypresses based on screen content:

1. **train.py** - Captures screen content when keys are pressed and saves images organized by key
2. **main.py** - Simulates keypresses by matching current screen content to saved images

## Features

- Automatic window detection and capture
- Real-time keypress recognition
- Dynamic key mapping system
- Multi-threaded processing
- Nearest neighbor image matching
- Safe key release on exit

## Requirements

- Python 3.7+
- Windows OS (due to specific screen capture dependencies)

## Installation

Install required dependencies:
```bash
pip install opencv-python numpy pillow keyboard pygetwindow scikit-learn pyautogui
```

## Usage

### 1. Data Collection (train.py)

Run the trainer to capture screen content when pressing keys:
```bash
python train.py
```

- Press keys to capture screen content
- Images are saved in `data/` directory organized by key
- Press Ctrl+C to exit

### 2. Key Simulation (main.py)

Run the simulator to automatically press keys based on screen content:
```bash
python main.py
```

- Program will automatically detect the target window
- Screenshots are continuously analyzed
- Matching keys are automatically pressed
- Press Ctrl+C to exit safely

## Configuration

### train.py Configuration
```python
MIN_INTERVAL = 0.0  # Minimum capture interval (seconds)
BASE_DIR = "data"   # Storage directory
TARGET_WINDOW_TITLE = "Minecraft"  # Window to capture
```

### main.py Configuration
```python
SIMILARITY_THRESHOLD = 0.75  # Image match threshold (0-1)
MAX_KEYS_TO_PRESS = 1        # Max keys to press simultaneously
SCREENSHOT_INTERVAL = 0.05   # Capture interval (seconds)
FEATURE_EXTRACT_INTERVAL = 60  # Model refresh interval (seconds)
BASE_DIR = "data"            # Training data directory
TARGET_WINDOW_TITLE = "Minecraft"  # Target application window
```

## Key Mapping

Special key mappings in main.py:
```python
DIRECTION_KEY_MAPPING = {
    'UP': 'up',
    'DOWN': 'down',
    'LEFT': 'left',
    'RIGHT': 'right'
}
```

Other keys are automatically mapped to lowercase names (e.g., 'A' -> 'a')

## Technical Notes

- Images are converted to grayscale and resized to 64x64 for processing
- Uses cosine similarity for image matching
- Features are averaged across multiple captures for each key
- System automatically releases all pressed keys on exit
- Window detection runs every 5 seconds

## Troubleshooting

If the target window isn't detected:
- Ensure the window title matches exactly
- Make sure the window is not minimized
- Check for special characters in the window title

If keypresses aren't being simulated:
- Verify sufficient training images exist in data directory
- Adjust SIMILARITY_THRESHOLD in main.py
- Check for key mapping conflicts

## AI-Generated Code Notice
This project contains code generated by AI tools (DeepSeek).  
- The original AI model may have been trained on publicly available code.  
- Use this code at your own risk.  
